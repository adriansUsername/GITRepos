@model Portfolio.Models.UserViewModel
@using Portfolio.Models
@{
    ViewBag.Title = "UserProfile";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Profile</h2>
<h3>@Html.DisplayFor(m => m.singleUser.userName)</h3>
<br />
<h2>Stories Edited: @Html.DisplayFor(m => m.singleUser.userEdited)</h2>
<br />
<h2>Stories Created:</h2>
@if (Model.storyViewModel.storyList.Count == 0)
{
    <h3>This user has no stories!</h3>
}
else
{

    foreach (StoryModel story in Model.storyViewModel.storyList)
    {
        @* check if a story is public OR if this is the current user's profile *@
        if (story.storyPublic || Model.singleUser.userName.Equals((string)Session["UserName"]))
        {
            @* get the genre and restriction for this story *@
            string storyRestrictionName = Model.storyViewModel.getByID(Model.storyViewModel.restrictionList, story.storyRestrictionID).restrictionName;
            string storyGenreName = Model.storyViewModel.getByID(Model.storyViewModel.genreList, story.storyGenreID).genreName;

            // get the correct rating
            string rating = "";

            if (story.storyRating == 0)
            {
                rating = "Not Rated";
            }
            else
            {
                rating = story.storyRating + " Stars";
            }

            <h3>@story.storyTitle - @storyGenreName - @storyRestrictionName - @rating</h3>
            @Html.ActionLink("Edit", "EditStoryProperties", "Story", story, null)
        }
        else
        {
            <h3>This user has no public stories!</h3>
        }
    }
}